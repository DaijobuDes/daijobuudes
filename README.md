Archived because I'll be rewriting this from scratch.
